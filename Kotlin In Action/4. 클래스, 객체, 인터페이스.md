# 4장: 클래스, 객체, 인터페이스

# 클래스

## 구현 및 상속에 관하여

### 구현 인터페이스가 두 개 이상

구현하는 인터페이스가 두 개 이상이며, 이름과 시그니처가 동일한 디폴트 메서드가 여러개라면?

만약 클래스 내부에서 따로 재정의(`override`) 를 하지 않으면 컴파일러 에러가 나타난다.(컴파일러가 중복되는 메서드 중에 누구를 써야할지를 모른다.)

```kotlin
interface Clickable {
	fun showOff() = println("I'm clickable!")
}

interface Focusable {
	fun showOff() = println("I'm focusable")
}

class Button: Clickable, Focusable {
	override fun showOff() {
		// super<Clickable>.showOff()
		super<Focusable>.showOff()
	}
}
```

재정의를 하거나 위처럼 `super<>` 꺽쇠 괄호 내부에 상위 타입을 지정하면 메서드 호출을 지정할 수 있다.

### **취약한 기반 클래스**

하위(자식) 클래스가 기반(부모) 클래스에 대해 가졌던 가정이 기반 클래스를 변경함으로써 깨져버린 경우

기반 클래스가 자식 클래스에게 상속하는 방법에 대해 정확한 규칙(어떤 메서드를 어떻게 오버라이드해야 하는지 등) 을 제공하지 않으면,

자식 클래스는 부모 클래스의 작성 의도와 다르게 오버라이드할 가능성이 있다.

→ 부모 클래스를 변경하면 자식 클래스의 동작이 예기치 않게 바뀔 수 있다.

그래서 이펙티브 자바에선 **상속을 위한 설계와 문서를 갖추거나, 그럴 수없다면 상속을 금지하란** 조언을 한다.

 → 그렇기에 코틀린은 자바와 다르게 기본적으로 final 로 만들었다. (상속이 불가능하다.)

 → 자바는 기본적으로 open 이라 final 로 명시하지 않으면 상속이 가능해서 문제가 생길 수 있다.

### **final 이 얻을 수 있는 이익**

클래스를 open 하지 않으면 기본적으로 final 이다.

→ 이는 다양한 경우에 **스마트 캐스팅**을 가능하게 한다.

클래스의 프로퍼티가 final 이 아니라면

해당 프로퍼티를 다른 클래스가 상속하면서 **커스텀 접근자를 정의함**으로써 스마트 캐스트의 요구 사항을 깰 수 있다.

![Untitled](4%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A2%E1%84%89%E1%85%B3,%20%E1%84%80%E1%85%A2%E1%86%A8%E1%84%8E%E1%85%A6,%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%90%E1%85%A5%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20ef58f2a2c1d042209201ff21ae16461a/Untitled.png)

스마트 캐스팅 조건에는

1. 불변성
2. 안정성

왼쪽 코드의 `type 프로퍼티`는

1  불변성은 `val` 로 만족하지만

2  안전성은 `getter` 로 값이 외부에 따라 언제든 값이 변할 수있기에 만족하지 못한다.

**그래서 보다시피 if 로 null 체크를 했는데도 nullable 이다.**

 오버라이드한 함수, 프로퍼티를 호출할 땐 실제 타입(동적 타입)에 따라 호출할 메서드가 결정된다.

→ 동적 디스패치 (런타임 시점에 객체 타입에 따라 동적으로 호출될 대상 메서드를 결정하는 방식)

### 클래스 내에서 상속 제어 변경자 종류

| 변경자 | 변경자가 붙어 있으면 | 설명 |
| --- | --- | --- |
| final | 오버라이드 불가능 | 기본 변경자 |
| open | 오버라이드 가능 | 반드시 open 을 명시해야 오버라이드 가능 |
| abstract | 반드시 오버라이드 | 추상 클래스의 멤버에만 붙일 수 있다.
구현이 있으면 안된다. |
| override  | 상위 클래스, 인스턴스 멤버를 오버라이드 하고 있음 | 오버라이드 멤버는 기본적으로 열려있다.
해당 오버라이드 멤버에 대한 또 오버라이드를 제한하려면 final 을 명시하자. |

### 인터페이스에서 상속 제어 변경자

`inteface` 엔 추상 프로퍼티, 함수를 만들 수 있다.

기본적으로 본문이 없으면 자동으로 `abstract` 변경자 취급

본문이 있으면 `open` 변경자 취급